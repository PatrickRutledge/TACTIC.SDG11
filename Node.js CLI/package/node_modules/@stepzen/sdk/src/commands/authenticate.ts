// Copyright IBM Corp. 2020, 2025

import debug from 'debug'
import fetch from '@stepzen/fetch'

import {ADMIN_VERIFY_URL} from '../shared/constants.js'
import {getRequestHeaders} from '../shared/request.js'
import {SDKConfiguration, StepZenAccount} from '../shared/types.js'

export default async (
  settings: StepZenAccount,
  sdkConfig: SDKConfiguration,
): Promise<boolean> => {
  const headers = getRequestHeaders(settings, sdkConfig)
  const url = `${settings.server}${ADMIN_VERIFY_URL}`

  debug('stepzen:headers')(headers)
  debug('stepzen:url')(url)

  try {
    const response = await fetch(url, {
      headers: headers as any,
      method: 'POST',
    })
    await response.json()
    return true
  } catch {
    return false
  }
}
